## Conventions для генерации кода

- **Главный источник правды**: все архитектурные и технические решения описаны в `@doc/vision.md`. Перед генерацией или правкой кода ассистент должен сверяться с этим документом.

- **Принцип KISS и MVP**
  - Всегда выбирать самое простое рабочее решение, соответствующее `@doc/vision.md`.
  - Не добавлять абстракции, слои и зависимости, не описанные или не подразумеваемые в `@doc/vision.md`.

- **Технологический стек и структура**
  - Использовать только технологии и подходы, указанные в `@doc/vision.md` (язык, библиотеки, структура каталогов, работа с LLM, деплой).
  - Соблюдать структуру модулей и ответственность файлов так, как она задана в `@doc/vision.md` (особенно для `src/llm_cursor`, `tests`, конфигурации и Docker).

- **Работа с LLM и данными**
  - Следовать модели данных и контрактам взаимодействия с LLM из `@doc/vision.md` (формат сообщений, хранение истории, конфигурация модели).
  - Не вводить сохранение состояния вне памяти процесса и не использовать БД, если это не изменено в `@doc/vision.md`.

- **Тестирование и качество**
  - Писать тесты только для критичной логики, как описано в `@doc/vision.md` (формирование промптов, обработка ответов, выбор сценариев, оркестрация).
  - Приоритет — читаемость и простота тестов, а не полнота покрытия.

- **Конфигурация и логгирование**
  - Чтение конфигурации и флагов выполнять только через подход, описанный в `@doc/vision.md` (модуль `config.py`, переменные окружения).
  - Использовать подход к логгированию и мониторингу LLM строго в рамках, описанных в `@doc/vision.md` (stdout, уровни логов, приватность).

- **Согласованность с документацией**
  - При любых нетривиальных изменениях кода, затрагивающих архитектуру или поведение, сверять их с `@doc/vision.md`. Если поведение расходится — либо адаптировать код под документ, либо сначала обновить `@doc/vision.md`.

